<!doctype html>
<html class="no-js">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Amaze UI Admin index Examples</title>
    <meta name="description" content="这是一个 index 页面">
    <meta name="keywords" content="index">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="renderer" content="webkit">
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <!-- DataTables -->
    <link rel="stylesheet" href="assets/css/jquery.dataTables.css">

    <link rel="icon" type="image/png" href="assets/i/favicon.png">
    <link rel="apple-touch-icon-precomposed" href="assets/i/app-icon72x72@2x.png">
    <meta name="apple-mobile-web-app-title" content="Amaze UI" />
    <link rel="stylesheet" href="assets/css/amazeui.min.css"/>
    <link rel="stylesheet" href="assets/css/admin.css">
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/app.js"></script>

</head>
<!--[if lte IE 9]><p class="browsehappy">升级你的浏览器吧！ <a href="http://se.360.cn/" target="_blank">升级浏览器</a>以获得更好的体验！</p><![endif]-->
</head>
<body>
<header class="am-topbar admin-header">
    <div class="am-topbar-brand"><img src="assets/i/logo.png"></div>
    <div class="am-collapse am-topbar-collapse" id="topbar-collapse">
        <ul class="am-nav am-nav-pills am-topbar-nav admin-header-list">
            <li class="kuanjie">
                <a href="sellerInfo.html">个人中心</a>
                <a href="login.html">退出</a>
            </li>
        </ul>
    </div>
</header>
<div class="am-cf admin-main">

    <div class="nav-navicon admin-main admin-sidebar">
        <div class="sideMenu am-icon-dashboard" style="color:#aeb2b7; margin: 10px 0 0 0;"> 欢迎本店管理员：清风抚雪</div>
        <div class="sideMenu">
            <h3 class="am-icon-flag"><em></em> <a href="index.html">商品管理</a></h3>
            <ul>
                <li><a href="goodsList.html">商品列表</a></li>
                <li ><a href="addGoods.html">添加新商品</a></li>
                <li><a href="categoryList.html">商品类别</a></li>
                <li ><a href="addCategory.html">添加新商品类别</a></li>
            </ul>
            <h3 class="am-icon-cart-plus"><em></em> <a href="#"> 订单管理</a></h3>
            <ul>
                <li><a href="订单列表.html">订单列表</a></li>
                <li><a href="">订单展示</a></li>
                <li><a href="">添加新订单</a></li>
                <li><a href="">修改订单</a></li>
            </ul>

            <h3 class="am-icon-users"><em></em> <a href="#">个人中心</a></h3>
            <ul>
                <li><a href="">修改信息</a></li>
            </ul>

        </div>
        <!-- sideMenu End -->
        <script type="text/javascript">
            jQuery(".sideMenu").slide({
                titCell:"h3", //鼠标触发对象
                targetCell:"ul", //与titCell一一对应，第n个titCell控制第n个targetCell的显示隐藏
                effect:"slideDown", //targetCell下拉效果
                delayTime:300 , //效果时间
                triggerTime:150, //鼠标延迟触发时间（默认150）
                defaultPlay:true,//默认是否执行效果（默认true）
                returnDefault:true //鼠标从.sideMen移走后返回默认状态（默认false）
            });
        </script>

    </div>

    <div class="daohang"></div>
    <div class="admin-biaogelist">

        <div class="listbiaoti am-cf">
            <ul class="am-icon-flag on"> 本店商品类别信息列表</ul>

            <dl class="am-icon-home" style="float: right;"> 当前位置： &gt; 商品类别列表</dl>

            <dl>
                <a type="button" class="am-btn am-btn-danger am-round am-btn-xs am-icon-plus" href="addCategory.html"> 添加产品类别</a>
            </dl>


        </div>

        <div class="am-btn-toolbars am-btn-toolbar am-kg am-cf">
            <ul>
                <li><input type="text" class="am-form-field am-input-sm am-input-xm" placeholder="关键词搜索" id="str"></li>
                <li><button type="button" class="am-btn am-radius am-btn-xs am-btn-success" style="margin-top: -1px;" onclick="selectCategoryBys()">搜索</button></li>
            </ul>
        </div>


        <form class="am-form am-g">
            <table width="100%" id="table" class="am-table am-table-bordered am-table-radius am-table-striped">
                <thead>
                <tr class="am-success">
                    <th class="table-check"><input type="checkbox" id="all" onchange="selectAll()"/></th>
                    <th class="table-id">商品二级类别ID</th>
                    <th class="table-title">商品二级类别</th>
                    <th class="table-type">商品一级类别ID</th>
                    <th class="table-type">商品一级类别</th>
                    <th width="163px" class="table-set">操作</th>
                </tr>
                </thead>
                <tbody id="dataTable">

                </tbody>
            </table>

            <div class="am-btn-group am-btn-group-xs">
             <button type="button" class="am-btn am-btn-default" onclick="delCheckCategory()"><span class="am-icon-trash-o"></span> 删除</button>
            </div>

        </form>




        <div class="foods">
            <ul>
                版权所有@2019.  <a href="http://www.cssmoban.com/" target="_blank" title="">商铺之家</a> -  More Shop <a href="http://www.cssmoban.com/" title="" target="_blank"></a>
            </ul>
            <dl>
                <a href="" title="返回头部" class="am-icon-btn am-icon-arrow-up"></a>
            </dl>
        </div>




    </div>

</div>

</div>

<!--[if lt IE 9]>
<script src="http://libs.baidu.com/jquery/1.11.1/jquery.min.js"></script>
<script src="http://cdn.staticfile.org/modernizr/2.8.3/modernizr.js"></script>
<script src="assets/js/polyfill/rem.min.js"></script>
<script src="assets/js/polyfill/respond.min.js"></script>
<script src="assets/js/amazeui.legacy.js"></script>
<![endif]-->

<!--[if (gte IE 9)|!(IE)]><!-->
<script src="assets/js/amazeui.min.js"></script>
<!--<![endif]-->


<!-- DataTables -->
<script src="assets/js/jquery.dataTables.js"></script>
<script src="datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
<script>


    function f(){
        //1.发送ajax请求获取数据
        $.ajax({
            type: 'POST',
            url: "getAllCategory",
            success: function(data){
                //循环
                var tabObj = $("#dataTable");
                console.log(data);
                $(data).each(function (index,item) {

                    var trHtml = "<tr>\n" +
                        "                    <td><input type=\"checkbox\" value="+item.childId+"></td>\n" +
                        "                    <td>"+item.childId+"</td>\n" +
                        "                    <td>"+item.childName+"</td>\n" +
                        "                    <td>"+item.fatherId+"</td>\n" +
                        "                    <td>"+item.fatherName+"</td>\n" +
                        "                    <td><div class=\"am-btn-toolbar\">\n" +
                        "                        <div class=\"am-btn-group am-btn-group-xs\">\n" +
                        "                            <button type='button' class=\"am-btn am-btn-default am-btn-xs am-text-secondary am-round\" onclick = \"jumpToEdit("+item.childId+")\"><span class=\"am-icon-pencil-square-o\"></span></button>\n" +
                        "                            <button type='button' class=\"am-btn am-btn-default am-btn-xs am-text-danger am-round\" onclick = \"delCategoryById("+item.childId+")\"><span class=\"am-icon-trash-o\"></span></button>\n" +
                        "                        </div>\n" +
                        "                    </div></td>\n" +
                        "                </tr>"
                    console.log(trHtml); //  2pm
                    //将字符串添加到table中
                    tabObj.append(trHtml);
                });
                $("#table").DataTable({
                    "paging":true,
                    "info":true,
                    "lengthChange":false,
                    "ordering":false,
                    "processing": true,
                    "searching": false,
                    "deferRender": true,
                    "language": {
                        "sProcessing": "处理中...",
                        "sLengthMenu": "显示 _MENU_ 项结果",
                        "sZeroRecords": "没有匹配结果",
                        "sInfo": "显示第 _START_ 至 _END_ 项结果，共 _TOTAL_ 项",
                        "sInfoEmpty": "显示第 0 至 0 项结果，共 0 项",
                        "sInfoFiltered": "(由 _MAX_ 项结果过滤)",
                        "sInfoPostFix": "",
                        "sSearch": "搜索:",
                        "sUrl": "",
                        "sEmptyTable": "表中数据为空",
                        "sLoadingRecords": "载入中...",
                        "sInfoThousands": ",",
                        "oPaginate": {
                            "sFirst": "首页",
                            "sPrevious": "上页",
                            "sNext": "下页",
                            "sLast": "末页"
                        },
                    }
                });
            },
            error:function (data) {
                // console.error(data);
                alert(22222)
            },
            dataType: "json"
        });
    }
    f();

    function jumpToEdit(childId){
        // alert(childId)
        var url = "editCategory.html?childId="+childId;
        window.location.href = url;
    }

    // 单个删除
    function delCategoryById(childId) {
        // alert(childId)
        $.ajax({
            type: "POST",
            url:"delByCid?childId="+childId,
            contentType:"application/json",
            success: function (data) {
                // alert("删除成功")
                window.location.href="categoryList.html";
            },
            error: function (data) {
                alert("删除失败")
            },
            dataType: "json"
        });
    }

    // 条件查询
    function selectCategoryBys() {
        $("#dataTable").empty();
        //1.发送ajax请求获取数据
        var str = $("#str").val();
        // alert(str);
        $.ajax({
            type: "GET",
            url: "selectCategoryBys",
            contentType:"application/json",
            data:{str},
            success: function(data){
                //循环
                // alert(3333)
                var tabObj = $("#dataTable");
                $(data).each(function (index,item) {
                    var trHtml = "<tr>\n" +
                        "                    <td><input type=\"checkbox\" value="+item.childId+"></td>\n" +
                        "                    <td>"+item.childId+"</td>\n" +
                        "                    <td>"+item.childName+"</td>\n" +
                        "                    <td>"+item.fatherId+"</td>\n" +
                        "                    <td>"+item.fatherName+"</td>\n" +
                        "                    <td><div class=\"am-btn-toolbar\">\n" +
                        "                        <div class=\"am-btn-group am-btn-group-xs\">\n" +
                        "                            <button type='button' class=\"am-btn am-btn-default am-btn-xs am-text-secondary am-round\" onclick = \"jumpToEdit("+item.childId+")\"><span class=\"am-icon-pencil-square-o\"></span></button>\n" +
                        "                            <button type='button' class=\"am-btn am-btn-default am-btn-xs am-text-danger am-round\" onclick = \"delCategoryById("+item.childId+")\"><span class=\"am-icon-trash-o\"></span></button>\n" +
                        "                        </div>\n" +
                        "                    </div></td>\n" +
                        "                </tr>"
                    //将字符串添加到table中
                    tabObj.append(trHtml);
                });
            },
            error:function (data) {
                console.log(data);
                alert(4444)
            },
            dataType: "json"
        });
    }

    var selectedCId = new  Array();
    //删除选中的 批量删除
    function delCheckCategory() {

        $(":checkbox:checked").each(function (i) {
            if ($(this).val() != '') {
                selectedCId.push($(this).val())
            }
        });
        alert(selectedCId);
        $.ajax({
            type: "POST",
            url: "delCheckCategoryIds",
            contentType: "application/json",
            data: JSON.stringify(selectedCId),
            success: function (data) {
                alert(data)
                window.location.href = "categoryList.html"
            },
            error: function (data) {
                alert("执行失败")
            },
            dataType: "json"
        });
    }

    // 全选与反选
    function selectAll() {
        var isCheck = $("#all").is(":checked"); //
        $("input[type='checkbox']").each(function () {
            this.checked = isCheck ; //
        })
    }

</script>

</body>
</html>